import type { SVGProps } from 'react'
import { IconCloud } from '@tabler/icons-react'
import { cn } from '@/lib/utils'

export function DeviconAmazonwebservices(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="1em"
      height="1em"
      viewBox="0 0 128 128"
      {...props}
    >
      {/* Icon from Devicon by konpa - https://github.com/devicons/devicon/blob/master/LICENSE */}
      <path
        fill="#252f3e"
        d="M36.379 53.64c0 1.56.168 2.825.465 3.75c.336.926.758 1.938 1.347 3.032c.207.336.293.672.293.969c0 .418-.254.84-.8 1.261l-2.653 1.77c-.379.25-.758.379-1.093.379c-.422 0-.844-.211-1.266-.59a13.3 13.3 0 0 1-1.516-1.98a34 34 0 0 1-1.304-2.485q-4.924 5.813-12.38 5.813c-3.535 0-6.355-1.012-8.421-3.032c-2.063-2.023-3.114-4.718-3.114-8.086c0-3.578 1.262-6.484 3.833-8.671c2.566-2.192 5.976-3.286 10.316-3.286c1.43 0 2.902.125 4.46.336c1.56.211 3.161.547 4.845.926v-3.074c0-3.2-.676-5.43-1.98-6.734C26.061 32.633 23.788 32 20.546 32c-1.473 0-2.988.168-4.547.547a33.4 33.4 0 0 0-4.547 1.433c-.676.293-1.18.461-1.473.547c-.296.082-.507.125-.675.125c-.59 0-.883-.422-.883-1.304v-2.063c0-.676.082-1.18.293-1.476c.21-.293.59-.586 1.18-.883q2.21-1.137 5.304-1.895c2.063-.547 4.254-.8 6.57-.8c5.008 0 8.672 1.136 11.032 3.41c2.316 2.273 3.492 5.726 3.492 10.359v13.64Zm-17.094 6.403c1.387 0 2.82-.254 4.336-.758c1.516-.508 2.863-1.433 4-2.695c.672-.8 1.18-1.684 1.43-2.695c.254-1.012.422-2.23.422-3.665v-1.765a34 34 0 0 0-3.871-.719a32 32 0 0 0-3.961-.25c-2.82 0-4.883.547-6.274 1.684c-1.387 1.136-2.062 2.734-2.062 4.84c0 1.98.504 3.453 1.558 4.464c1.012 1.051 2.485 1.559 4.422 1.559m33.809 4.547c-.758 0-1.262-.125-1.598-.422c-.34-.254-.633-.84-.887-1.64L40.715 29.98c-.25-.843-.38-1.39-.38-1.687c0-.672.337-1.05 1.013-1.05h4.125c.8 0 1.347.124 1.644.421c.336.25.59.84.84 1.64l7.074 27.876l6.57-27.875c.208-.84.462-1.39.797-1.64c.34-.255.93-.423 1.688-.423h3.367c.8 0 1.348.125 1.684.422c.336.25.633.84.8 1.64l6.653 28.212l7.285-28.211c.25-.84.547-1.39.84-1.64c.336-.255.887-.423 1.644-.423h3.914c.676 0 1.055.336 1.055 1.051c0 .21-.043.422-.086.676s-.125.59-.293 1.05L80.801 62.57c-.254.84-.547 1.387-.887 1.64c-.336.255-.883.423-1.598.423h-3.62c-.801 0-1.348-.13-1.684-.422c-.34-.297-.633-.844-.801-1.684l-6.527-27.16l-6.485 27.117c-.21.844-.46 1.391-.8 1.684c-.337.297-.926.422-1.684.422Zm54.105 1.137c-2.187 0-4.379-.254-6.484-.758s-3.746-1.055-4.84-1.684c-.676-.379-1.137-.8-1.305-1.18a2.9 2.9 0 0 1-.254-1.18v-2.148c0-.882.336-1.304.97-1.304q.376 0 .757.129c.25.082.629.25 1.05.418a23 23 0 0 0 4.634 1.476c1.683.336 3.324.504 5.011.504c2.653 0 4.715-.465 6.145-1.39c1.433-.926 2.191-2.274 2.191-4c0-1.18-.379-2.145-1.136-2.946c-.758-.8-2.192-1.516-4.254-2.191l-6.106-1.895c-3.074-.969-5.348-2.398-6.734-4.293c-1.39-1.855-2.106-3.918-2.106-6.105q0-2.655 1.137-4.676a10.8 10.8 0 0 1 3.031-3.453c1.262-.965 2.696-1.684 4.38-2.188s3.452-.715 5.304-.715c.926 0 1.894.043 2.82.168c.969.125 1.852.293 2.738.461c.84.211 1.641.422 2.399.676q1.137.379 1.77.758c.59.336 1.011.672 1.261 1.05q.38.509.379 1.391v1.98c0 .884-.336 1.348-.969 1.348c-.336 0-.883-.171-1.597-.507q-3.604-1.641-8.086-1.641c-2.399 0-4.293.379-5.598 1.18c-1.309.797-1.98 2.02-1.98 3.746c0 1.18.421 2.191 1.261 2.988c.844.8 2.403 1.602 4.633 2.316l5.98 1.895c3.032.969 5.22 2.316 6.524 4.043s1.938 3.707 1.938 5.895c0 1.812-.38 3.453-1.094 4.882c-.758 1.434-1.77 2.696-3.074 3.707c-1.305 1.051-2.864 1.809-4.672 2.36c-1.895.586-3.875.883-6.024.883m0 0"
      />
      <path
        fill="#f90"
        d="M118 73.348c-4.432.063-9.664 1.052-13.621 3.832c-1.223.883-1.012 2.062.336 1.894c4.508-.547 14.44-1.726 16.21.547c1.77 2.23-1.976 11.62-3.663 15.79c-.504 1.26.59 1.769 1.726.8c7.41-6.231 9.348-19.242 7.832-21.137c-.757-.925-4.388-1.79-8.82-1.726M1.63 75.859c-.927.116-1.347 1.236-.368 2.121c16.508 14.902 38.359 23.872 62.613 23.872c17.305 0 37.43-5.43 51.281-15.66c2.273-1.688.297-4.254-2.02-3.204c-15.534 6.57-32.421 9.77-47.788 9.77c-22.778 0-44.8-6.273-62.653-16.633c-.39-.231-.755-.304-1.064-.266z"
      />
    </svg>
  )
}

export function VscodeIconsFileTypeCloudflare(props: SVGProps<SVGSVGElement>) {
  return (
    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 32 32" {...props}>
      {/* Icon from VSCode Icons by Roberto Huertas - https://github.com/vscode-icons/vscode-icons/blob/master/LICENSE */}
      <path
        fill="#fff"
        d="m27.386 15.826l-3.253-.756l-.58-.232l-14.93.116v7.203l18.763.058z"
        className="a"
      />
      <path
        fill="#f48120"
        d="M21.287 21.518a1.66 1.66 0 0 0-.174-1.51a1.8 1.8 0 0 0-1.22-.639l-10.108-.116c-.058 0-.116-.058-.174-.058a.11.11 0 0 1 0-.175c.058-.116.116-.174.232-.174l10.166-.116a3.66 3.66 0 0 0 2.962-2.207l.581-1.51c0-.059.058-.117 0-.175a6.62 6.62 0 0 0-12.721-.697a3.17 3.17 0 0 0-2.092-.581a3.026 3.026 0 0 0-2.672 2.672a3.2 3.2 0 0 0 .058 1.046a4.24 4.24 0 0 0-4.124 4.24a2.4 2.4 0 0 0 .058.64a.185.185 0 0 0 .174.174H20.88c.116 0 .233-.058.233-.175z"
        className="b"
      />
      <path
        fill="#faad3f"
        d="M24.482 15.012h-.29c-.059 0-.117.058-.175.116l-.407 1.395a1.66 1.66 0 0 0 .175 1.51a1.8 1.8 0 0 0 1.22.639l2.149.116c.058 0 .116.058.174.058a.11.11 0 0 1 0 .174c-.058.117-.116.175-.232.175l-2.208.116a3.66 3.66 0 0 0-2.962 2.207l-.116.523c-.058.058 0 .174.116.174h7.668a.154.154 0 0 0 .174-.174a6.3 6.3 0 0 0 .232-1.51a5.554 5.554 0 0 0-5.518-5.519"
        className="c"
      />
    </svg>
  )
}

export function AntDesignAliyunOutlined(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="1em"
      height="1em"
      viewBox="0 0 1024 1024"
      {...props}
    >
      {/* Icon from Ant Design Icons by HeskeyBaozi - https://github.com/ant-design/ant-design-icons/blob/master/LICENSE */}
      <path
        fill="currentColor"
        d="M959.2 383.9c-.3-82.1-66.9-148.6-149.1-148.6H575.9l21.6 85.2l201 43.7a42.58 42.58 0 0 1 32.9 39.7c.1.5.1 216.1 0 216.6a42.58 42.58 0 0 1-32.9 39.7l-201 43.7l-21.6 85.3h234.2c82.1 0 148.8-66.5 149.1-148.6zM225.5 660.4a42.58 42.58 0 0 1-32.9-39.7c-.1-.6-.1-216.1 0-216.6c.8-19.4 14.6-35.5 32.9-39.7l201-43.7l21.6-85.2H213.8c-82.1 0-148.8 66.4-149.1 148.6V641c.3 82.1 67 148.6 149.1 148.6H448l-21.6-85.3zm200.9-158.8h171v21.3h-171z"
      />
    </svg>
  )
}

export function DeviconSupabase(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="1em"
      height="1em"
      viewBox="0 0 128 128"
      {...props}
    >
      {/* Icon from Devicon by konpa - https://github.com/devicons/devicon/blob/master/LICENSE */}
      <defs>
        <linearGradient
          id="SVG7pxEXcwp"
          x1="53.974"
          x2="94.163"
          y1="54.974"
          y2="71.829"
          gradientTransform="translate(29.387 60.096)scale(1.1436)"
          gradientUnits="userSpaceOnUse"
        >
          <stop offset="0" stopColor="#249361" />
          <stop offset="1" stopColor="#3ecf8e" />
        </linearGradient>
        <linearGradient
          id="SVGwe4qUjnW"
          x1="36.156"
          x2="54.484"
          y1="30.578"
          y2="65.081"
          gradientTransform="translate(29.387 60.096)scale(1.1436)"
          gradientUnits="userSpaceOnUse"
        >
          <stop offset="0" />
          <stop offset="1" stopOpacity="0" />
        </linearGradient>
      </defs>
      <path
        fill="url(#SVG7pxEXcwp)"
        d="M102.24 186.21c-3.267 4.117-9.904 1.862-9.977-3.397l-1.156-76.906h51.715c9.365 0 14.587 10.817 8.763 18.149z"
        transform="translate(-27.722 -60.338)"
      />
      <path
        fill="url(#SVGwe4qUjnW)"
        fillOpacity=".2"
        d="M102.24 186.21c-3.267 4.117-9.904 1.862-9.977-3.397l-1.156-76.906h51.715c9.365 0 14.587 10.817 8.763 18.149z"
        transform="translate(-27.722 -60.338)"
      />
      <path
        fill="#3ecf8e"
        d="M53.484 2.128c3.267-4.117 9.905-1.862 9.977 3.396l.508 76.907H12.902c-9.365 0-14.587-10.817-8.764-18.149z"
      />
    </svg>
  )
}

// MinIO icon
export function SimpleIconsMinio(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="1em"
      height="1em"
      viewBox="0 0 24 24"
      {...props}
    >
      <path
        fill="currentColor"
        d="M2.637 16.328c-.268-.074-.46-.156-.64-.272a1.26 1.26 0 0 1-.397-.397c-.19-.318-.19-.715 0-1.033l4.54-7.863c.19-.318.53-.513.897-.513h9.926c.367 0 .707.195.897.513l4.54 7.863c.19.318.19.715 0 1.033a1.26 1.26 0 0 1-.397.397c-.18.116-.372.198-.64.272l-9.363 2.58-9.363-2.58zm9.363.907l7.5-2.067-3.5-6.062H8l-3.5 6.062 7.5 2.067z"
      />
    </svg>
  )
}

// Tencent Cloud icon
export function TencentCloudIcon(props: SVGProps<SVGSVGElement>) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="1em"
      height="1em"
      viewBox="0 0 24 24"
      {...props}
    >
      <path
        fill="currentColor"
        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15h-2v-6h2v6zm4 0h-2v-6h2v6zm0-8H9V7h6v2z"
      />
    </svg>
  )
}

// Provider icon key type
export type ProviderIconKey =
  | 'aws-s3'
  | 'cloudflare-r2'
  | 'aliyun-oss'
  | 'tencent-cos'
  | 'minio'
  | 'backblaze-b2'
  | 'supabase'
  | 'default'

// Icon mapping
const PROVIDER_ICONS: Record<ProviderIconKey, React.ComponentType<SVGProps<SVGSVGElement>>> = {
  'aws-s3': DeviconAmazonwebservices,
  'cloudflare-r2': VscodeIconsFileTypeCloudflare,
  'aliyun-oss': AntDesignAliyunOutlined,
  'tencent-cos': TencentCloudIcon,
  minio: SimpleIconsMinio,
  'backblaze-b2': IconCloud as React.ComponentType<SVGProps<SVGSVGElement>>,
  supabase: DeviconSupabase,
  default: IconCloud as React.ComponentType<SVGProps<SVGSVGElement>>
}

// Background color mapping
const PROVIDER_BG_COLORS: Record<ProviderIconKey, string> = {
  'aws-s3': 'bg-orange-100',
  'cloudflare-r2': 'bg-orange-50',
  'aliyun-oss': 'bg-orange-100 text-orange-600',
  'tencent-cos': 'bg-blue-100 text-blue-600',
  minio: 'bg-red-100 text-red-600',
  'backblaze-b2': 'bg-red-100 text-red-600',
  supabase: 'bg-emerald-100 text-emerald-600',
  default: 'bg-muted text-muted-foreground'
}

interface ProviderBrandIconProps {
  /** Provider variant or type key */
  iconKey?: string
  /** Icon size */
  size?: number
  /** Additional class name */
  className?: string
  /** Whether to show background */
  showBackground?: boolean
}

/**
 * Provider brand icon component
 * Displays the appropriate brand icon based on the provider variant/type
 */
export function ProviderBrandIcon({
  iconKey,
  size = 24,
  className,
  showBackground = true
}: ProviderBrandIconProps) {
  const key = (iconKey || 'default') as ProviderIconKey
  const IconComponent = PROVIDER_ICONS[key] || PROVIDER_ICONS.default
  const bgColor = PROVIDER_BG_COLORS[key] || PROVIDER_BG_COLORS.default

  if (showBackground) {
    return (
      <div
        className={cn(
          'flex items-center justify-center rounded-lg',
          bgColor,
          className
        )}
        style={{ width: size + 16, height: size + 16 }}
      >
        <IconComponent width={size} height={size} />
      </div>
    )
  }

  return <IconComponent width={size} height={size} className={className} />
}

/**
 * Get provider icon key from provider data
 */
export function getProviderIconKey(provider: {
  type: string
}): ProviderIconKey {
  if (provider.type in PROVIDER_ICONS) {
    return provider.type as ProviderIconKey
  }
  return 'default'
}
